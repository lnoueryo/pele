<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>バンボー</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: whitesmoke;
    }
    #canvasContainer {
      margin: 0;
      padding: 0;
      border: 8px solid black;
    }
    #start-button {
        position: absolute;
        top: 50%;
        left: 50%;
    }
    .hide {
        display: none;
    }
  </style>
    <script src="./dist/bundle.js"></script>
</head>
<body>
  <div id="canvasContainer">
    <button id="start-button" onclick="onStartGameClicked()">start</button>
    <canvas id="gameCanvas"></canvas>
  </div>
</body>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = 800;
canvas.height = 800;

const createPlayer = () => {
    return new lib.Player(
        canvas.width / 2,
        20,
        40,
        40,
        0,
        0,
        0.5,
        -15,
        false,
        8,
    )
}

const onStartGameClicked = (e) => {
    const button = document.getElementById('start-button')
    button.classList.add('hide');
    cm = new lib.CanvasManager(
        canvas,
        ctx,
        createPlayer()
    )
    cm.startGame()
    isPlaying = true;
    timer = setInterval(() => {
        if(cm.isGameOver()) {
            clearInterval(timer)
            button.classList.remove('hide');
        }
    }, 100)
}

let timer = null;

let cm = null;

document.addEventListener('keyup', (e) => {
    if(e.key === 'Enter') {
        if(cm === null || cm.isGameOver()) onStartGameClicked()
    }
})
</script>
</html>
